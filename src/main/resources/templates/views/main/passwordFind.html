<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">

	<title>MOZ-ATES</title>

	<!-- Context Path add -->
	<link id="contextPathHolder" th:data-contextPath="${#httpServletRequest.getContextPath()}" />

	<link rel="stylesheet" th:href="@{/css/login.css}">
	<link rel="stylesheet" th:href="@{/css/reset.css}">

	<script th:src="@{/js/lib/jquery-1.12.4.min.js}"></script>

	<script>
		var contextPath = document.getElementById('contextPathHolder').getAttribute("data-contextpath");
	</script>
</head>

<body>
	<div class="admin-wrap">
		<div class="admin-center" id="contentWrap">

			<!-- ID Find Input -->
			<div class="admin-form">
				<div id="admin-sub-logo">
					<div th:onclick="|location.href='@{/login}'|"><img src="/images/login-back.png" alt="back"></div>
					<div>
						<img src="/images/inatro-logo2.png" alt="logo">
					</div>
				</div>

				<div th:text="#{passwordFind.title}">Find Password</div>

				<form id="findIdForm">
					<div id="idFindWrap">
						<div class="admin-input jf-input">
							<label class="cm-label-bf" th:text="|ID|">ID</label>
							<input type="text" class="form-input" id="oprtrAccountId" name="oprtrAccountId" 
								th:placeholder="#{passwordFind.label.id}">
							<p class="none infoText idInfo" th:text="#{passwordFind.infoTxt.id}"></p>
						</div>

						<div class="admin-input jf-input">
							<label class="cm-label-bf" th:text="#{passwordFind.label.name}">Name</label>
							<input type="text" class="form-input" id="oprtrNm" name="oprtrNm"
								th:placeholder="#{passwordFind.placeholder.name}">
							<p class="none infoText nmInfo" th:text="#{passwordFind.infoTxt.name}"></p>
						</div>
						<div class="admin-input complete">
							<button type="button" class="sub-btn form-button" th:onclick="|location.href='@{/login}'|"
								th:text="#{passwordFind.button.login}">Login</button>
							<button type="button" class="main-btn form-button" onclick="findPw()"
								th:text="#{passwordFind.button.find}">Find</button>
						</div>
					</div>
				</form>
			</div>

		</div>

	</div>



	<script th:inline="javascript">

		function findPw() {
			const oprtrAccountIdElmnt = document.getElementById("oprtrAccountId");
			const oprtrNmElmnt = document.getElementById("oprtrNm");

			// Reset Info Text
			const infoTextList = document.getElementsByClassName('infoText');
			for (const element of infoTextList) {
				if (!element.classList.contains('none')) {
					element.classList.add('none');
				}
			}

			let oprtrAccountId = oprtrAccountIdElmnt.value;
			let oprtrNm = oprtrNmElmnt.value;

			if (oprtrAccountId == '') {
				oprtrAccountIdElmnt.focus();
				document.getElementsByClassName('idInfo')[0].classList.remove('none');
				return false;
			}

			if (oprtrNm == '') {
				oprtrNmElmnt.focus();
				document.getElementsByClassName('nmInfo')[0].classList.remove('none');
				return false;
			}

			const formData = new FormData(document.getElementById('findIdForm'));
			fetch('/password/find.ajax', {
				method: "post",
				body: formData
			})
				.then(response => response.json())
				.then((result) => {
					if (result.code === 200) {
						let successMsg = /*[[#{passwordFind.result.sussess}]]*/;
						alert(successMsg);
						location.href = /*[[@{/login}]]*/;
					} else {
						let failMsg = /*[[#{passwordFind.result.fail}]]*/;
						alert(failMsg);
					}
				});
		}
	</script>
</body>

</html>